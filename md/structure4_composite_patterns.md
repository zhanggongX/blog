# 组合模式
&emsp;&emsp;组合模式，就是将对象组合成树形结构以表示‘部分-整体’的层次接口，组合模式使得用户对单个对象和组合对象的使用具有一致性。<br>
&emsp;&emsp;例如说，有一家公司，这家公司有子公司，子公司又有各种办事处，那我们怎么在程序里管理这家公司呢？<br>
&emsp;&emsp;为每一个子公司写一个类吗？例如总公司财务部，分公司财务部？这是很low的做法。<br>
&emsp;&emsp;还是说共享某一个类？然后在对象里通过判断不同的公司部门执行不同的逻辑？例如说判断是总公司财务部，就为总公司人员发工资？更是增加了无穷的复杂度。这种情况下，就非常适合使用组合模式。<br>
&emsp;&emsp;首先总结一下，总公司有子公司，总公司有财务部、人力部，子公司也有财务部、人力部门。这就是一个树形结构啊，总公司就是根，各级具体的部门就是叶子，分公司又可以有更多的分公司。<br>
&emsp;&emsp;我们可以抽象出来一个类，这个类有增加子节点，删除子节点，显示子节点，职责等方法，然后所有的部门都继承这个类，然后在各自的类里实现自己的逻辑，再通过add方法把所有的节点都加入到树中，就完美的完成了这个公司的组织管理。例如发工资，总公司财务部发工资，再遍历所有的子公司发公司，一直到叶子节点。就完成了发工资的业务，中间没有任何逻辑判断，注意这里所说的判断是处理流程的判断，如果某个子公司发工资和业绩挂钩，而其他的又不挂钩，那这个子公司在发工资的实现是不一样即可，但是调用方式是一样的，不用判断是这个子公司才去走不同的流程。<br>
&emsp;&emsp;组合模式的透明方式和安全方式。我们发现财务部和人力部在各个公司层级中是叶子节点，是不会有子公司和子部门的，那么我们还是让他们继承抽象类，那他们还是要实现增加和删除节点的方法的，这样不就不安全且没有任何实际意义了吗？那就需要安全方式了，那就是在根节点抽象类中不声明增加和删除节点的方法，需要实现的子类中再去增加，这样就不是所有的子类都要实现增加删除方法了。但是这样也是有弊端的，这样所有的叶子和树枝就不具有相同的接口，客户端调用就需要做相应的判断了，带来了不便，我个人建议还是用透明的方式即可，用这种方式，例如在财务部的增加方法里直接不处理即可，对整个流程不会有任何影响。<br>
&emsp;&emsp;那什么时候适合使用组合模式呢？当你发现需求中体现部分与整体层次的结构时，以及你希望用户可以忽略组合对象与单个对象的不同，统一地使用组合结构中的所有对象时，就应该考虑组合模式了。简单的说，就是你发现业务是部分-整体的关系的，且他们的业务逻辑大体相同，你想统一的调用所有的对象而不是各种判断，就可以使用组合模式了。

- [详见代码 ](https://github.com/zhangonga/design-patterns/tree/master/src/main/java/tech/zg/patterns/structure/structure4_composite_patterns)

- [返回首页](https://github.com/zhangonga/design-patterns#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0)